{#

This file is part of the Sonata package.

(c) Thomas Rabaix <thomas.rabaix@sonata-project.org>

For the full copyright and license information, please view the LICENSE
file that was distributed with this source code.

#}

{% extends base_template %}



{% block javascripts %}
    {{ parent() }}
    {% if admin.id(object) is not null %}
        <script src="{{ asset('/bundles/sonatacore/vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js?v=5.2') }}" type="text/javascript"></script>
        <script>
            $(document).ready(function () {
                $("#numero").val(0);
            });
            $.ajax({
                //url: Routing.generate('catalogo_formaspago'),
                url: "{{ path('catalogo_formaspago') }}",
                async: true,
                dataType: 'json',
                success: function (data) {
                    if (Object.keys(data).length > 0) {
                        $.each(data.items, function (idx, item) {
                            $('#idformapago').append($('<option/>', {
                                value: item.key, text: item.value}));
                        });
                    }
                    ;
                }
            });
            $.ajax({
                url: "{{ path('catalogo_bancos') }}",
                async: true,
                dataType: 'json',
                success: function (data) {
                    if (Object.keys(data).length > 0) {
                        $.each(data.items, function (idx, item) {
                            $('#idbanco').append($('<option/>', {
                                value: item.key, text: item.value}));
                        });
                    }
                    ;
                }
            });
            $(function () {
                $('#fecha').datetimepicker({
                    format: 'DD/MM/YYYY',
                });
            });

            function buscar_factura() {
                $(function () {
                    numero_factura = $('#numero_factura').val();
                    var path = "{{ path('remesas_facturas', { 'numero_factura': 10 }) }}";
                    $.ajax({
                        url: path,
                        async: true,
                        dataType: 'json',
                        success: function (data) {
                            if (Object.keys(data).length > 0) {
                                $.each(data.items, function (idx, item) {
                                    $('#idfactura').append($('<option/>', {
                                        value: item.key, text: item.value}));
                                });
                            }
                            ;
                        }
                    });
                });
            }
        </script>

    {% endif %}
{% endblock %}
{% block title %}
    {% if admin.id(object) is not null %}
        {{ "title_edit"|trans({'%name%': admin.toString(object)|truncate(75) }, 'SonataAdminBundle') }}
    {% else %}
        {{ "title_create"|trans({}, 'SonataAdminBundle') }}
    {% endif %}
{% endblock%}

{% block navbar_title %}
    {{ block('title') }}
{% endblock %}

{% block actions %}
    <li>{% include 'SonataAdminBundle:Button:show_button.html.twig' %}</li>
    <li>{% include 'SonataAdminBundle:Button:history_button.html.twig' %}</li>
    <li>{% include 'SonataAdminBundle:Button:acl_button.html.twig' %}</li>
    <li>{% include 'SonataAdminBundle:Button:list_button.html.twig' %}</li>
    <li>{% include 'SonataAdminBundle:Button:create_button.html.twig' %}</li>
    {% endblock %}

{% block tab_menu %}{{ knp_menu_render(admin.sidemenu(action), {'currentClass' : 'active', 'template': admin_pool.getTemplate('tab_menu_template')}, 'twig') }}{% endblock %}

{% use 'SonataAdminBundle:CRUD:base_edit_form.html.twig' with form as parentForm %}
{% import "SonataAdminBundle:CRUD:base_edit_form_macro.html.twig" as form_helper %}

{% block form %}
    {{ block('parentForm') }}
    {% if admin.id(object) is not null %}
        <div class="row" style="margin-top: 10px;">
            <div class="col-md-8">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            Recibos de cobros
                        </h4>
                    </div>
                    <div class="box-body">
                        <div class="row">
                            <div class="com-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="numero">NUMERO:</label>
                                    <div class="input-group">
                                        <input type="number" name="" id="numero" value="" maxlength="8" style="width: 100px;" required="required" class="form-control">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="fecha">FECHA: (dd/mm/aaaa)</label>
                                    <div class='input-group date' id='fecha' style="width: 100px;" >
                                        <input type='text' class="form-control" maxlength="10" style="width: 100px;" required="required"/>
                                        <span class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"></span>
                                        </span>
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label for="idfactura">FACTURA:</label>
                                    <div class="input-group">
                                        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#myModal">...</button>
                                        <select name="idfactura" id="idfactura" class="form-control"></select>
                                    </div>
                                </div>



                                <div class="form-group">
                                    <label for="idformapago">FORMA_PAGO:</label>
                                    <div class="input-group">
                                        <select id="idformapago" name="idformapago" class="form-control"></select>
                                    </div>
                                </div>

                            </div>

                            <div class="com-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="idbanco">BANCO:</label>
                                    <div class="input-group">
                                        <select name="idbanco" id="idbanco" class="form-control"></select>
                                    </div>
                                </div>
                            </div>

                            <div class="com-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="numero">CHEQUE:</label>
                                    <div class="input-group">
                                        <input type="text" name="" id="" value="" maxlength="10" style="width: 200px;" class="form-control">
                                    </div>
                                </div>
                            </div>                   
                            <div class="com-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="numero">MONTO:</label>
                                    <div class="input-group">
                                        <input type="number" name="" id="" value="" maxlength="10" style="width: 100px;" required="required" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="com-md-6 col-lg-6">
                                <div class="form-group">
                                    <label for="numero"></label>
                                    <div class="input-group">
                                        <input type="button" onclick="alert('hola')" value="Procesar recibo" class="btn btn-success">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div id="detalle">
            <table border="1px" style="background: gainsboro;">
                <tr>
                    <td>NUMERO</td>
                    <td>FECHA</td>
                    <td>FACTURA</td>
                    <td>FORMA_PAGO</td>
                    <td>CHEQUE</td>
                    <td>BANCO</td>
                    <td>MONTO</td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td><input type="button" onclick="alert('hola')" value="Anular" class="btn btn-danger"></td>
                </tr>
            </table>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="myModal" role="dialog">
            <div class="modal-dialog">

                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Modal Header</h4>
                    </div>
                    <div class="modal-body">
                        <input type="text" id="numero_factura" name="numero_factura">
                        <input type="button" onclick="buscar_factura()" value="Buscar factura">
                        <div id="div_resultado"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    {% endif %}


{% endblock %}
